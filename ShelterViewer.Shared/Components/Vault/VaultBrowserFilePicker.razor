@inherits ComponentBase
@inject VaultService VaultService
@inject IVaultFileService VaultFileService

<input type="file" @ref="fileInput" @onchange="HandleChange" disabled="@Disabled" />

@code {
    private ElementReference fileInput;

    [Parameter] public bool Disabled { get; set; }
    [Parameter] public EventCallback OnVaultLoaded { get; set; }

    private async Task HandleChange(ChangeEventArgs _)
    {
        var jsonString = await VaultFileService.OpenVaultAsync(fileInput);
        if (!string.IsNullOrWhiteSpace(jsonString))
        {
            VaultService.InitializeVault(jsonString);
            await OnVaultLoaded.InvokeAsync();
        }
    }
}
